<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat de Consulta de Casos</title>

    <link rel="stylesheet" href="./css/styles.css" />
  </head>

  <body>
    <nav class="navbar">
      <div class="navbar-left">
        <a href="index.html">
          <img src="Imagen.png" class="navbar-icon" alt="Logo" />
        </a>
        <span class="navbar-title">Consulta de Casos</span>
        <button class="navbar-toggle" id="navbar-toggle" aria-label="Menú">
          <span></span><span></span><span></span>
        </button>
      </div>

      <div class="navbar-links" id="navbar-links">
        <a href="buscar.html">Consultar en Documentación</a>
        <a href="buscarweb.html">Consultar en la WEB</a>
        <a href="upload.html">Subir Archivo</a>
      </div>
    </nav>

    <div id="chat-container">
      <div id="chat-messages"></div>

      <div class="input-group">
        <div class="select-dropdown">
          <button id="select-btn" type="button">
            <span id="select-label" class="select-label">Tabla reporte</span>
            <span class="select-arrow">&#43;</span>
          </button>
          <ul id="select-options" class="select-options">
            <li data-value="0" class="selected">Tabla reporte</li>
            <li data-value="1">Lenguaje Natural</li>
          </ul>
          <input type="hidden" id="request-type" value="0" />
        </div>

        <input type="text" id="user-input" placeholder="Escribe tu pregunta..." />

        <div class="voice-message">
          <button id="voiceBtn" aria-label="Mensaje de voz" title="Mensaje de voz">
            <i id="voiceIcon" class="fa-solid fa-microphone"></i>
          </button>
        </div>

        <button class="send-button" onclick="sendMessage()">
          <span class="send-button-text">Enviar</span>
          <i class="fa-solid fa-arrow-up icon"></i>
        </button>
      </div>
    </div>

    <!-- Scripts -->
    <script type="module">
      import { initNav } from './js/shared/nav.js';
      import { initVoice } from './js/shared/voice.js';

      initNav('navbar-toggle', 'navbar-links');

      // Init voice
      const voiceController = initVoice({
        voiceBtnId: 'voiceBtn',
        voiceIconId: 'voiceIcon',
        inputId: 'user-input',
        lang: 'es-ES',
        continuous: false,
        interimResults: false,
        onResult: (transcript) => {
          document.getElementById('user-input').value = transcript;
        },
        onError: (evt) => {
          console.error('Speech error', evt);
        }
      });
    </script>
    <script type="module" src="./js/chat.js"></script>

    <script src="https://kit.fontawesome.com/6dc81ce773.js" crossorigin="anonymous"></script>
  </body>
</html>
